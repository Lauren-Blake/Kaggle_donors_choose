<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Lauren Blake" />

<meta name="date" content="2018-04-06" />

<title>Word frequency analysis</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.0/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Kaggle_donors_choose</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lauren-blake/Kaggle_donors_choose">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Word frequency analysis</h1>
<h4 class="author"><em>Lauren Blake</em></h4>
<h4 class="date"><em>2018-04-06</em></h4>

</div>


<!-- The file analysis/chunks.R contains chunks that define default settings
shared across the workflowr files. -->
<!-- Update knitr chunk options -->
<!-- Insert the date the file was last updated -->
<p><strong>Last updated:</strong> 2018-04-15</p>
<!-- Insert the code version (Git commit SHA1) if Git repository exists and R
 package git2r is installed -->
<p><strong>Code version:</strong> 5a57fa1</p>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Driving question: Are certain words more likely to be associated with “approved” applications and others with “non approved” words?</p>
<p>The following RMarkdown file uses files from Donors Choose and performs preliminary analysis with Latent Dirichlet allocation. The sentiment analysis was aided by the code and explanations provided in chapter 6 <a href="https://www.tidytextmining.com/" class="uri">https://www.tidytextmining.com/</a>.</p>
</div>
<div id="get-started" class="section level1">
<h1>Get Started</h1>
<pre class="r"><code># Libraries

library(dplyr)</code></pre>
<pre><code>
Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>The following objects are masked from &#39;package:stats&#39;:

    filter, lag</code></pre>
<pre><code>The following objects are masked from &#39;package:base&#39;:

    intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>library(stringr)
library(tidytext)</code></pre>
<pre><code>Warning: package &#39;tidytext&#39; was built under R version 3.4.4</code></pre>
<pre class="r"><code>library(ggplot2)
library(tidyverse)</code></pre>
<pre><code>── Attaching packages ────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>✔ tibble  1.4.2     ✔ readr   1.1.1
✔ tidyr   0.7.2     ✔ purrr   0.2.4
✔ tibble  1.4.2     ✔ forcats 0.2.0</code></pre>
<pre><code>── Conflicts ───────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(&quot;quanteda&quot;)</code></pre>
<pre><code>Warning: package &#39;quanteda&#39; was built under R version 3.4.4</code></pre>
<pre><code>Package version: 1.1.1</code></pre>
<pre><code>Parallel computing: 2 of 8 threads used.</code></pre>
<pre><code>See https://quanteda.io for tutorials and examples.</code></pre>
<pre><code>
Attaching package: &#39;quanteda&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:utils&#39;:

    View</code></pre>
<pre class="r"><code>library(&quot;plotly&quot;)</code></pre>
<pre><code>
Attaching package: &#39;plotly&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:ggplot2&#39;:

    last_plot</code></pre>
<pre><code>The following object is masked from &#39;package:stats&#39;:

    filter</code></pre>
<pre><code>The following object is masked from &#39;package:graphics&#39;:

    layout</code></pre>
<pre class="r"><code># Open the datasets

train &lt;- read.csv(&quot;~/Dropbox/DonorsChoose/train.csv&quot;)
test &lt;- read.csv(&quot;~/Dropbox/DonorsChoose/test.csv&quot;)
resources &lt;- read.csv(&quot;~/Dropbox/DonorsChoose/resources.csv&quot;)</code></pre>
<div id="make-data-into-a-tibble-and-find-out-the-most-common-words-in-approved-versus-non-approved-essays" class="section level2">
<h2>Make data into a tibble and find out the most common words in approved versus non-approved essays</h2>
<pre class="r"><code># First, we want to select project id, essay 1, and if the project was approved or not

id_title &lt;- c(1, 16, 10)

train_text &lt;- train[,id_title]
train_text[,1] &lt;- as.character(train_text[,1])
train_text[,2] &lt;- as.numeric(train_text[,2])
train_text[,3] &lt;- as.character(train_text[,3])


train_text &lt;- as.tibble(train_text)

tidy_books &lt;- train_text %&gt;% unnest_tokens(word, project_essay_1)

# Take out stop (common) words

tidy_books &lt;- tidy_books %&gt;%
  anti_join(stop_words)</code></pre>
<pre><code>Joining, by = &quot;word&quot;</code></pre>
<pre class="r"><code>word_counts &lt;- tidy_books %&gt;%
  anti_join(stop_words) %&gt;%
  count(id, word, sort = TRUE) %&gt;%
  ungroup()</code></pre>
<pre><code>Joining, by = &quot;word&quot;</code></pre>
<pre class="r"><code># Convert dtm

#chapters_dtm &lt;- word_counts %&gt;%
#  cast_dtm(id, word, n)

#chapters_dtm

# We have two topics (approved and not approved); set a seed so that the output of the model is predictable
#ap_lda &lt;- LDA(chapters_dtm, k = 2, control = list(seed = 1234))

#topics &lt;- tidy(ap_lda, matrix = &quot;beta&quot;)

# Fnd the top words

#top_terms &lt;- topics %&gt;%
#  group_by(topic) %&gt;%
#  top_n(5, beta) %&gt;%
#  ungroup() %&gt;%
#  arrange(topic, -beta)

#top_terms %&gt;%
#  mutate(term = reorder(term, beta)) %&gt;%
#  ggplot(aes(term, beta, fill = factor(topic))) +
#  geom_col(show.legend = FALSE) +
#  facet_wrap(~ topic, scales = &quot;free&quot;) +
#  coord_flip()
# chapters_gamma &lt;- tidy(ap_lda, matrix = &quot;gamma&quot;)


# Look at frequency of different words


frequency &lt;- tidy_books %&gt;% 
  group_by(project_is_approved) %&gt;% 
  count(word, sort = TRUE) %&gt;% 
  left_join(tidy_books %&gt;% 
              group_by(project_is_approved) %&gt;% 
              summarise(total = n())) %&gt;%
  mutate(freq = n/total)</code></pre>
<pre><code>Joining, by = &quot;project_is_approved&quot;</code></pre>
<pre class="r"><code>frequency &lt;- frequency %&gt;% 
  select(project_is_approved, word, freq) %&gt;%
  spread(project_is_approved, freq)


library(scales)</code></pre>
<pre><code>
Attaching package: &#39;scales&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:purrr&#39;:

    discard</code></pre>
<pre><code>The following object is masked from &#39;package:readr&#39;:

    col_factor</code></pre>
<pre class="r"><code>ggplot(frequency, aes(frequency[,2], frequency[,3])) +
  geom_jitter(alpha = 0.1, size = 2.5, width = 0.25, height = 0.25) +
  geom_text(aes(label = word), check_overlap = TRUE, vjust = 1.5) +
  scale_x_log10(labels = percent_format()) +
  scale_y_log10(labels = percent_format()) +
  geom_abline(color = &quot;red&quot;)</code></pre>
<pre><code>Warning: Removed 26368 rows containing missing values (geom_point).</code></pre>
<pre><code>Warning: Removed 26368 rows containing missing values (geom_text).</code></pre>
<p><img src="figure/Word_frequency.Rmd/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>graph_associated_words &lt;- function(min_freq){
word_ratios &lt;- tidy_books %&gt;%
  filter(!str_detect(word, &quot;_&quot;)) %&gt;%
  count(word, project_is_approved) 

word_ratios &lt;- word_ratios[which(word_ratios$n &gt; min_freq), ]

new_word_ratios &lt;- word_ratios %&gt;%
  ungroup() %&gt;%
  spread(project_is_approved, n, fill = 0) %&gt;%
  mutate_if(is.numeric, funs((. + 1) / sum(. + 1))) 

logratio &lt;- log(new_word_ratios[,2] / new_word_ratios[,3])

new_word_ratios &lt;- cbind(new_word_ratios, logratio)
colnames(new_word_ratios) &lt;- c(&quot;word&quot;, &quot;not_approved&quot;, &quot;approved&quot;, &quot;logratio&quot;)

#arrange_new_word_ratios &lt;- new_word_ratios[order(new_word_ratios[,4]),] 

#arrange_new_word_ratios &lt;- new_word_ratios[order(-new_word_ratios[,4]),] 

new_word_ratios %&gt;% 
  arrange(abs(new_word_ratios[,4]))


new_word_ratios %&gt;%
  group_by(logratio &lt; 0) %&gt;%
  top_n(15, abs(logratio)) %&gt;%
  ungroup() %&gt;%
  mutate(word = reorder(word, logratio)) %&gt;%
  ggplot(aes(word, logratio, fill = logratio &lt; 0)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  ylab(&quot;log odds ratio (not approved/approved)&quot;) +
  scale_fill_discrete(name = &quot;&quot;, labels = c(&quot;Not approved&quot;, &quot;Approved&quot;))

}

# Graph words associated with approved and not approved at different minimium frequencies
graph_associated_words(5000)</code></pre>
<p><img src="figure/Word_frequency.Rmd/unnamed-chunk-2-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>graph_associated_words(10000)</code></pre>
<p><img src="figure/Word_frequency.Rmd/unnamed-chunk-2-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>graph_associated_words(15000)</code></pre>
<p><img src="figure/Word_frequency.Rmd/unnamed-chunk-2-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>graph_associated_words(20000)</code></pre>
<p><img src="figure/Word_frequency.Rmd/unnamed-chunk-2-5.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>graph_associated_words(25000)</code></pre>
<p><img src="figure/Word_frequency.Rmd/unnamed-chunk-2-6.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="which-words-in-essay-1-are-more-likely-to-be-associated-with-approval-or-not" class="section level2">
<h2>Which words in essay 1 are more likely to be associated with approval or not?</h2>
<pre class="r"><code>library(purrr)
library(&quot;ggrepel&quot;)

# Get frequency of words

frequency &lt;- tidy_books %&gt;% 
  group_by(project_is_approved) %&gt;% 
  count(word, sort = TRUE) %&gt;% 
  left_join(tidy_books %&gt;% 
              group_by(project_is_approved) %&gt;% 
              summarise(total = n())) %&gt;%
  mutate(freq = n/total)</code></pre>
<pre><code>Joining, by = &quot;project_is_approved&quot;</code></pre>
<pre class="r"><code># Select words that have been used at least 2000 times

frequency_50 &lt;- frequency[which(frequency$n &gt; 2000),]

frequency_50_0 &lt;- frequency_50[which(frequency_50$project_is_approved != 1), ]
frequency_50_1 &lt;- frequency_50[which(frequency_50$project_is_approved == 1), ]

appears_twice &lt;- merge(frequency_50_0, frequency_50_1, by = c(&quot;word&quot;))
dim(appears_twice)</code></pre>
<pre><code>[1] 99  9</code></pre>
<pre class="r"><code>ggplot(appears_twice, aes(freq.x, freq.y)) +
  geom_point(alpha = 0.8, size = 2.5, width = 0.25, height = 0.25) +
  geom_label_repel(aes(label = word)) +
  scale_x_log10(labels = percent_format()) +
  scale_y_log10(labels = percent_format()) +
  geom_abline(color = &quot;red&quot;)</code></pre>
<pre><code>Warning: Ignoring unknown parameters: width, height</code></pre>
<p><img src="figure/Word_frequency.Rmd/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>p &lt;- ggplot(appears_twice, aes(freq.x, freq.y)) + 
  geom_point(aes(text = word), alpha = 0.8, size = 2.5, width = 0.25, height = 0.25)  +
  scale_x_log10(labels = percent_format()) +
  scale_y_log10(labels = percent_format()) +
  geom_abline(color = &quot;red&quot;)</code></pre>
<pre><code>Warning: Ignoring unknown parameters: width, height</code></pre>
<pre><code>Warning: Ignoring unknown aesthetics: text</code></pre>
<pre class="r"><code>ggplotly(p)</code></pre>
<pre><code>We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`</code></pre>
<div id="166107c7ec98e" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="166107c7ec98e">{"x":{"data":[{"x":[-2.6690953379002,-2.64231314345895,-2.78241275522205,-2.63157454598278,-2.61170610344267,-2.76145186755611,-2.45933055451584,-2.79747404878591,-2.44118582509995,-2.32461876933612,-2.75867934434759,-2.17765075553015,-1.86132721000328,-2.31060574820269,-2.68346428551757,-2.59500306524136,-2.68246933781573,-2.08277607976688,-2.73730207969069,-2.60500303303723,-2.3912387077294,-2.37690810565547,-2.28765448090498,-2.43318233985244,-2.74412062417667,-2.51148748453853,-2.74949895275067,-2.47733602503587,-2.61438824918731,-2.53009235286049,-2.43655406292325,-2.74622560265356,-2.74680146282444,-2.23837449685182,-2.62586680256567,-2.7378662206861,-2.69575566499409,-2.20939734893062,-2.61072210516662,-2.75749651706563,-2.58575813208142,-2.40326265695143,-2.41037448129943,-2.79920430797459,-2.40975526103498,-2.42900416723408,-2.64534382206566,-2.38127373891546,-1.86047790498254,-2.34515098416567,-1.79386278896816,-2.61837132508985,-2.40632138915774,-2.6375076229828,-2.72125284640697,-2.06323746939542,-2.30466646635962,-2.30920094516023,-2.57244237993481,-2.57670590306596,-2.64473599204075,-2.29343172393931,-2.70490267807406,-2.65612091308185,-2.64080569841232,-2.67900486203809,-2.65131517818402,-2.78303869020704,-2.43683622502212,-2.62514043597737,-2.39815477898824,-2.69490260150648,-2.40843132601343,-2.58061849242901,-2.49980271497546,-2.50593661037957,-2.55653792767375,-2.74297673989315,-1.44541626314781,-2.58088058928784,-2.4051827723384,-2.74641747121507,-2.41805498693095,-2.38895761095491,-1.14158841545109,-2.79942107587622,-2.62354669297082,-2.66957744098235,-2.57579801521156,-2.26005555976049,-2.41760470748999,-2.71335636556093,-2.71442474120896,-2.41509173385451,-2.49590475778142,-2.39234130147948,-2.79083365853735,-2.65518661121867,-2.38693997907094],"y":[-2.69673667894227,-2.65028280630789,-2.71666479622225,-2.66649760742724,-2.61296395267791,-2.83237696318222,-2.43100679158232,-2.65222878212471,-2.43486971771208,-2.34364209648049,-2.75494606671051,-2.17087047446179,-1.84870947559345,-2.31175832736461,-2.7234404991646,-2.61813914506923,-2.67457747129143,-2.04388275913389,-2.80264116413427,-2.60996294235886,-2.35596333369146,-2.32855994422648,-2.31813890130476,-2.38864286530549,-2.71672852716108,-2.52394480295056,-2.77839623100617,-2.45679653942979,-2.63735080741542,-2.55340014095779,-2.44402478986536,-2.75812439911176,-2.77902108881718,-2.20707673348009,-2.64210161792812,-2.77861666641327,-2.71257378140334,-2.1577063216549,-2.51930838012331,-2.75418115749013,-2.64366092874961,-2.38048560725798,-2.40021907298457,-2.78312329244313,-2.44097412339981,-2.46132148993164,-2.59952243160871,-2.35572733048293,-1.8477733702335,-2.29711994933952,-1.78650053830342,-2.62675709429208,-2.44725122152356,-2.64831828686229,-2.73986452557466,-2.02779729298614,-2.33957137458221,-2.27768563734396,-2.63782887135033,-2.607329190075,-2.62585137033106,-2.26185906813812,-2.695551368378,-2.67356644240909,-2.66465635356378,-2.69576387835207,-2.65332895872802,-2.79904410150692,-2.42660567545021,-2.65365955591366,-2.41702306327018,-2.5859653457712,-2.33104409922369,-2.54321557621099,-2.47230870560804,-2.46788400164927,-2.56342608626043,-2.74650286104812,-1.42793280581239,-2.63102640248667,-2.43760943888137,-2.79804377713399,-2.46394885174319,-2.40780377323867,-1.13582178594189,-2.82417820886531,-2.63982648832437,-2.75735387644174,-2.61644094743504,-2.24128889513162,-2.43767647773951,-2.74080666939292,-2.71736635145241,-2.32089690334389,-2.49356880453348,-2.36352743460004,-2.81238158250138,-2.63737735272161,-2.37811184696838],"text":["1<br />freq.x: -2.669095<br />freq.y: -2.696737","academic<br />freq.x: -2.642313<br />freq.y: -2.650283","access<br />freq.x: -2.782413<br />freq.y: -2.716665","activities<br />freq.x: -2.631575<br />freq.y: -2.666498","amazing<br />freq.x: -2.611706<br />freq.y: -2.612964","art<br />freq.x: -2.761452<br />freq.y: -2.832377","backgrounds<br />freq.x: -2.459331<br />freq.y: -2.431007","books<br />freq.x: -2.797474<br />freq.y: -2.652229","challenges<br />freq.x: -2.441186<br />freq.y: -2.434870","children<br />freq.x: -2.324619<br />freq.y: -2.343642","city<br />freq.x: -2.758679<br />freq.y: -2.754946","class<br />freq.x: -2.177651<br />freq.y: -2.170870","classroom<br />freq.x: -1.861327<br />freq.y: -1.848709","community<br />freq.x: -2.310606<br />freq.y: -2.311758","create<br />freq.x: -2.683464<br />freq.y: -2.723440","creative<br />freq.x: -2.595003<br />freq.y: -2.618139","daily<br />freq.x: -2.682469<br />freq.y: -2.674577","day<br />freq.x: -2.082776<br />freq.y: -2.043883","disabilities<br />freq.x: -2.737302<br />freq.y: -2.802641","district<br />freq.x: -2.605003<br />freq.y: -2.609963","diverse<br />freq.x: -2.391239<br />freq.y: -2.355963","eager<br />freq.x: -2.376908<br />freq.y: -2.328560","education<br />freq.x: -2.287654<br />freq.y: -2.318139","english<br />freq.x: -2.433182<br />freq.y: -2.388643","enjoy<br />freq.x: -2.744121<br />freq.y: -2.716729","environment<br />freq.x: -2.511487<br />freq.y: -2.523945","everyday<br />freq.x: -2.749499<br />freq.y: -2.778396","excited<br />freq.x: -2.477336<br />freq.y: -2.456797","experience<br />freq.x: -2.614388<br />freq.y: -2.637351","experiences<br />freq.x: -2.530092<br />freq.y: -2.553400","families<br />freq.x: -2.436554<br />freq.y: -2.444025","family<br />freq.x: -2.746226<br />freq.y: -2.758124","feel<br />freq.x: -2.746801<br />freq.y: -2.779021","free<br />freq.x: -2.238374<br />freq.y: -2.207077","fun<br />freq.x: -2.625867<br />freq.y: -2.642102","future<br />freq.x: -2.737866<br />freq.y: -2.778617","goal<br />freq.x: -2.695756<br />freq.y: -2.712574","grade<br />freq.x: -2.209397<br />freq.y: -2.157706","graders<br />freq.x: -2.610722<br />freq.y: -2.519308","grow<br />freq.x: -2.757497<br />freq.y: -2.754181","hands<br />freq.x: -2.585758<br />freq.y: -2.643661","hard<br />freq.x: -2.403263<br />freq.y: -2.380486","home<br />freq.x: -2.410374<br />freq.y: -2.400219","homes<br />freq.x: -2.799204<br />freq.y: -2.783123","income<br />freq.x: -2.409755<br />freq.y: -2.440974","kids<br />freq.x: -2.429004<br />freq.y: -2.461321","kindergarten<br />freq.x: -2.645344<br />freq.y: -2.599522","language<br />freq.x: -2.381274<br />freq.y: -2.355727","learn<br />freq.x: -1.860478<br />freq.y: -1.847773","learners<br />freq.x: -2.345151<br />freq.y: -2.297120","learning<br />freq.x: -1.793863<br />freq.y: -1.786501","level<br />freq.x: -2.618371<br />freq.y: -2.626757","life<br />freq.x: -2.406321<br />freq.y: -2.447251","live<br />freq.x: -2.637508<br />freq.y: -2.648318","lives<br />freq.x: -2.721253<br />freq.y: -2.739865","love<br />freq.x: -2.063237<br />freq.y: -2.027797","low<br />freq.x: -2.304666<br />freq.y: -2.339571","lunch<br />freq.x: -2.309201<br />freq.y: -2.277686","materials<br />freq.x: -2.572442<br />freq.y: -2.637829","math<br />freq.x: -2.576706<br />freq.y: -2.607329","ni<br />freq.x: -2.644736<br />freq.y: -2.625851","nmy<br />freq.x: -2.293432<br />freq.y: -2.261859","nour<br />freq.x: -2.704903<br />freq.y: -2.695551","opportunities<br />freq.x: -2.656121<br />freq.y: -2.673566","opportunity<br />freq.x: -2.640806<br />freq.y: -2.664656","parents<br />freq.x: -2.679005<br />freq.y: -2.695764","population<br />freq.x: -2.651315<br />freq.y: -2.653329","positive<br />freq.x: -2.783039<br />freq.y: -2.799044","poverty<br />freq.x: -2.436836<br />freq.y: -2.426606","program<br />freq.x: -2.625140<br />freq.y: -2.653660","provide<br />freq.x: -2.398155<br />freq.y: -2.417023","read<br />freq.x: -2.694903<br />freq.y: -2.585965","reading<br />freq.x: -2.408431<br />freq.y: -2.331044","ready<br />freq.x: -2.580618<br />freq.y: -2.543216","receive<br />freq.x: -2.499803<br />freq.y: -2.472309","reduced<br />freq.x: -2.505937<br />freq.y: -2.467884","resources<br />freq.x: -2.556538<br />freq.y: -2.563426","safe<br />freq.x: -2.742977<br />freq.y: -2.746503","school<br />freq.x: -1.445416<br />freq.y: -1.427933","science<br />freq.x: -2.580881<br />freq.y: -2.631026","skills<br />freq.x: -2.405183<br />freq.y: -2.437609","social<br />freq.x: -2.746417<br />freq.y: -2.798044","special<br />freq.x: -2.418055<br />freq.y: -2.463949","student<br />freq.x: -2.388958<br />freq.y: -2.407804","students<br />freq.x: -1.141588<br />freq.y: -1.135822","success<br />freq.x: -2.799421<br />freq.y: -2.824178","successful<br />freq.x: -2.623547<br />freq.y: -2.639826","supplies<br />freq.x: -2.669577<br />freq.y: -2.757354","support<br />freq.x: -2.575798<br />freq.y: -2.616441","teach<br />freq.x: -2.260056<br />freq.y: -2.241289","teacher<br />freq.x: -2.417605<br />freq.y: -2.437676","teachers<br />freq.x: -2.713356<br />freq.y: -2.740807","teaching<br />freq.x: -2.714425<br />freq.y: -2.717366","technology<br />freq.x: -2.415092<br />freq.y: -2.320897","time<br />freq.x: -2.495905<br />freq.y: -2.493569","title<br />freq.x: -2.392341<br />freq.y: -2.363527","unique<br />freq.x: -2.790834<br />freq.y: -2.812382","variety<br />freq.x: -2.655187<br />freq.y: -2.637377","world<br />freq.x: -2.386940<br />freq.y: -2.378112"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0.8,"size":9.4488188976378,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.88231270889748,-1.05869678242983],"y":[-2.88231270889748,-1.05869678242983],"text":"intercept: 0<br />slope: 1","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":37.2602739726027},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[-2.88231270889748,-1.05869678242983],"ticktext":["1%"],"tickvals":[-2],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"freq.x","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[-2.91720472204424,-1.05099402707987],"ticktext":["1%"],"tickvals":[-2],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"freq.y","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest"},"source":"A","attrs":{"166105e287d02":{"text":{},"x":{},"y":{},"type":"ggplotly"},"1661034273e99":{"intercept":{},"slope":{}}},"cur_data":"166105e287d02","visdat":{"166105e287d02":["function (y) ","x"],"1661034273e99":["function (y) ","x"]},"config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="which-words-in-essay-2-are-more-likely-to-be-associated-with-approval" class="section level2">
<h2>Which words in essay 2 are more likely to be associated with approval?</h2>
<pre class="r"><code>id_title &lt;- c(1, 16, 11)

train_text &lt;- train[,id_title]
train_text[,1] &lt;- as.character(train_text[,1])
train_text[,2] &lt;- as.numeric(train_text[,2])
train_text[,3] &lt;- as.character(train_text[,3])


train_text &lt;- as.tibble(train_text)

tidy_books &lt;- train_text %&gt;% unnest_tokens(word, project_essay_2)

# Take out stop (common) words

tidy_books &lt;- tidy_books %&gt;%
  anti_join(stop_words)</code></pre>
<pre><code>Joining, by = &quot;word&quot;</code></pre>
<pre class="r"><code>word_counts &lt;- tidy_books %&gt;%
  anti_join(stop_words) %&gt;%
  count(id, word, sort = TRUE) %&gt;%
  ungroup()</code></pre>
<pre><code>Joining, by = &quot;word&quot;</code></pre>
<pre class="r"><code>frequency &lt;- tidy_books %&gt;% 
  group_by(project_is_approved) %&gt;% 
  count(word, sort = TRUE) %&gt;% 
  left_join(tidy_books %&gt;% 
              group_by(project_is_approved) %&gt;% 
              summarise(total = n())) %&gt;%
  mutate(freq = n/total)</code></pre>
<pre><code>Joining, by = &quot;project_is_approved&quot;</code></pre>
<pre class="r"><code># Select words that have been used at least 2000 times

frequency_50 &lt;- frequency[which(frequency$n &gt; 2000),]

frequency_50_0 &lt;- frequency_50[which(frequency_50$project_is_approved != 1), ]
frequency_50_1 &lt;- frequency_50[which(frequency_50$project_is_approved == 1), ]

appears_twice &lt;- merge(frequency_50_0, frequency_50_1, by = c(&quot;word&quot;))
dim(appears_twice)</code></pre>
<pre><code>[1] 104   9</code></pre>
<pre class="r"><code>ggplot(appears_twice, aes(freq.x, freq.y)) +
  geom_point(alpha = 0.8, size = 2.5, width = 0.25, height = 0.25) +
  geom_label_repel(aes(label = word)) +
  scale_x_log10(labels = percent_format()) +
  scale_y_log10(labels = percent_format()) +
  geom_abline(color = &quot;red&quot;)</code></pre>
<pre><code>Warning: Ignoring unknown parameters: width, height</code></pre>
<p><img src="figure/Word_frequency.Rmd/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>p &lt;- ggplot(appears_twice, aes(freq.x, freq.y)) + 
  geom_point(aes(text = word), alpha = 0.8, size = 2.5, width = 0.25, height = 0.25)  +
  scale_x_log10(labels = percent_format()) +
  scale_y_log10(labels = percent_format()) +
  geom_abline(color = &quot;red&quot;)</code></pre>
<pre><code>Warning: Ignoring unknown parameters: width, height</code></pre>
<pre><code>Warning: Ignoring unknown aesthetics: text</code></pre>
<pre class="r"><code>ggplotly(p)</code></pre>
<pre><code>We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`</code></pre>
<div id="16610368b8840" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="16610368b8840">{"x":{"data":[{"x":[-2.85405857574985,-2.77014812345816,-2.51153984395259,-2.8152673295428,-2.37314984514841,-2.56372602934175,-2.71248293481498,-2.30152949633735,-2.63962728557384,-2.80419947223627,-2.80570940676691,-2.79451081943761,-2.41806239700333,-2.26247948194957,-1.83113175495688,-2.7789469349885,-2.79932812844136,-2.8098890009688,-2.32601184792005,-2.65955436188552,-2.33846832347034,-2.7762885234115,-2.61105071890074,-2.82583177028441,-2.78197960543138,-2.82941114067128,-2.57049325796433,-2.76169485574394,-2.77259387519411,-2.59283913423421,-2.80533143069265,-2.70959421590061,-2.65619137092972,-2.74625463133617,-2.65099655825025,-2.45531623371176,-2.77382193554516,-2.6058883463757,-2.77540599012283,-2.52233334418353,-2.4507835481871,-2.77084550535334,-2.65645945395176,-2.70838363816373,-2.76118261528916,-2.5880020732959,-2.54934586707564,-2.86259535148481,-2.7146238274415,-2.00055872130234,-2.68758308548576,-1.77306714430685,-2.81856553891377,-2.63744004759495,-2.84032973344537,-2.5395045453692,-2.79230534123917,-2.811035906077,-2.33067292118301,-2.02815729208592,-2.21738281201543,-2.68585798100536,-2.73582845662605,-2.71893753636975,-2.64468708434325,-2.71909239266731,-2.44497738574698,-2.79267214403285,-2.86475602500573,-2.52410919869661,-2.60636598676688,-2.7841331362006,-2.21738281201543,-2.63846796400832,-2.37841919493848,-2.41069088511812,-2.07983473715627,-2.86087451919113,-2.73470313251935,-2.61226011673577,-1.93344275129449,-2.36932588760021,-2.43770561226916,-2.75357063788068,-2.08347529407228,-2.79047595992467,-2.84527197149659,-2.8240530873262,-2.3109879719259,-1.19322539913496,-2.811035906077,-2.72173343324863,-2.30821291787113,-2.6998545835235,-2.6242939257014,-2.67466895056939,-2.79970091342725,-2.21782210964627,-2.83686270108917,-2.22600542599521,-2.64260413319496,-2.74658451702002,-2.44729054424821,-2.56005925504297],"y":[-2.88722737827456,-2.90899857741379,-2.41297938974056,-2.76000612545752,-2.49661204420782,-2.70286170561923,-2.52011433774855,-2.08032346479662,-2.69870995258574,-2.89621114109072,-2.77307629030236,-2.93639138011201,-2.4888224102606,-2.21341034764029,-1.81389101241809,-2.83975874535937,-2.92372183423449,-2.8990932545875,-2.38277201595551,-2.62559874626189,-2.30872717099189,-2.84147739113879,-2.74985336048635,-2.88621560414151,-2.81536699135769,-2.86218916812279,-2.71462666580588,-2.95995884581806,-2.8174386307993,-2.68113287976457,-2.97816655732592,-2.81403363005888,-2.76315238643485,-2.86703251881553,-2.62250825197577,-2.56469734124749,-2.8703037173175,-2.67614320168622,-2.87662797668822,-2.5325011815074,-2.62173396302561,-2.79121870315192,-2.61213023080684,-2.74846108355599,-2.76295507594154,-2.82387560178538,-2.57124470863294,-2.95322478075195,-2.74358253707751,-2.08341270250328,-2.71578801669951,-1.8388449076707,-2.77643529890616,-2.6116923737237,-2.69447714726361,-2.64843331846598,-2.77897171533439,-2.94874949412601,-2.3055798455252,-2.30910361240032,-2.26206359752064,-2.56550144161033,-2.76791493239663,-2.72169306692955,-2.59767787023739,-2.78971751091437,-2.49645945136625,-2.86713996868996,-2.96316431426006,-2.60250050886293,-2.54768254133877,-2.8130204763282,-2.28871781861398,-2.65267546524983,-2.38152906305693,-2.26978901838854,-1.98294318666124,-2.914756165729,-2.65802049253391,-2.73790610422214,-2.009950780124,-2.46463889957897,-2.51468688689811,-2.67107333556461,-2.14342001904206,-2.87396347304277,-2.81517626035686,-2.96603361827013,-2.31786317661934,-1.19017043607317,-2.93371080000948,-2.82074175409794,-2.59405273460003,-2.74485110270086,-2.69836980584127,-2.74379820162913,-2.90180059381483,-2.18031682153795,-2.95156833085544,-2.19191940299612,-2.77273028485431,-2.7792349507088,-2.4854625414071,-2.52266730767707],"text":["ability<br />freq.x: -2.854059<br />freq.y: -2.887227","academic<br />freq.x: -2.770148<br />freq.y: -2.908999","access<br />freq.x: -2.511540<br />freq.y: -2.412979","active<br />freq.x: -2.815267<br />freq.y: -2.760006","activities<br />freq.x: -2.373150<br />freq.y: -2.496612","art<br />freq.x: -2.563726<br />freq.y: -2.702862","book<br />freq.x: -2.712483<br />freq.y: -2.520114","books<br />freq.x: -2.301529<br />freq.y: -2.080323","build<br />freq.x: -2.639627<br />freq.y: -2.698710","building<br />freq.x: -2.804199<br />freq.y: -2.896211","center<br />freq.x: -2.805709<br />freq.y: -2.773076","centers<br />freq.x: -2.794511<br />freq.y: -2.936391","children<br />freq.x: -2.418062<br />freq.y: -2.488822","class<br />freq.x: -2.262479<br />freq.y: -2.213410","classroom<br />freq.x: -1.831132<br />freq.y: -1.813891","comfortable<br />freq.x: -2.778947<br />freq.y: -2.839759","community<br />freq.x: -2.799328<br />freq.y: -2.923722","concepts<br />freq.x: -2.809889<br />freq.y: -2.899093","create<br />freq.x: -2.326012<br />freq.y: -2.382772","daily<br />freq.x: -2.659554<br />freq.y: -2.625599","day<br />freq.x: -2.338468<br />freq.y: -2.308727","develop<br />freq.x: -2.776289<br />freq.y: -2.841477","education<br />freq.x: -2.611051<br />freq.y: -2.749853","engage<br />freq.x: -2.825832<br />freq.y: -2.886216","engaged<br />freq.x: -2.781980<br />freq.y: -2.815367","engaging<br />freq.x: -2.829411<br />freq.y: -2.862189","environment<br />freq.x: -2.570493<br />freq.y: -2.714627","equipment<br />freq.x: -2.761695<br />freq.y: -2.959959","excited<br />freq.x: -2.772594<br />freq.y: -2.817439","experience<br />freq.x: -2.592839<br />freq.y: -2.681133","experiences<br />freq.x: -2.805331<br />freq.y: -2.978167","explore<br />freq.x: -2.709594<br />freq.y: -2.814034","feel<br />freq.x: -2.656191<br />freq.y: -2.763152","flexible<br />freq.x: -2.746255<br />freq.y: -2.867033","focus<br />freq.x: -2.650997<br />freq.y: -2.622508","fun<br />freq.x: -2.455316<br />freq.y: -2.564697","future<br />freq.x: -2.773822<br />freq.y: -2.870304","games<br />freq.x: -2.605888<br />freq.y: -2.676143","goal<br />freq.x: -2.775406<br />freq.y: -2.876628","grade<br />freq.x: -2.522333<br />freq.y: -2.532501","hands<br />freq.x: -2.450784<br />freq.y: -2.621734","hard<br />freq.x: -2.770846<br />freq.y: -2.791219","home<br />freq.x: -2.656459<br />freq.y: -2.612130","improve<br />freq.x: -2.708384<br />freq.y: -2.748461","increase<br />freq.x: -2.761183<br />freq.y: -2.762955","items<br />freq.x: -2.588002<br />freq.y: -2.823876","kids<br />freq.x: -2.549346<br />freq.y: -2.571245","knowledge<br />freq.x: -2.862595<br />freq.y: -2.953225","language<br />freq.x: -2.714624<br />freq.y: -2.743583","learn<br />freq.x: -2.000559<br />freq.y: -2.083413","learners<br />freq.x: -2.687583<br />freq.y: -2.715788","learning<br />freq.x: -1.773067<br />freq.y: -1.838845","lessons<br />freq.x: -2.818566<br />freq.y: -2.776435","level<br />freq.x: -2.637440<br />freq.y: -2.611692","library<br />freq.x: -2.840330<br />freq.y: -2.694477","life<br />freq.x: -2.539505<br />freq.y: -2.648433","literacy<br />freq.x: -2.792305<br />freq.y: -2.778972","lives<br />freq.x: -2.811036<br />freq.y: -2.948749","love<br />freq.x: -2.330673<br />freq.y: -2.305580","materials<br />freq.x: -2.028157<br />freq.y: -2.309104","math<br />freq.x: -2.217383<br />freq.y: -2.262064","move<br />freq.x: -2.685858<br />freq.y: -2.565501","ni<br />freq.x: -2.735828<br />freq.y: -2.767915","nmy<br />freq.x: -2.718938<br />freq.y: -2.721693","nthe<br />freq.x: -2.644687<br />freq.y: -2.597678","opportunities<br />freq.x: -2.719092<br />freq.y: -2.789718","opportunity<br />freq.x: -2.444977<br />freq.y: -2.496459","options<br />freq.x: -2.792672<br />freq.y: -2.867140","physical<br />freq.x: -2.864756<br />freq.y: -2.963164","play<br />freq.x: -2.524109<br />freq.y: -2.602501","practice<br />freq.x: -2.606366<br />freq.y: -2.547683","program<br />freq.x: -2.784133<br />freq.y: -2.813020","project<br />freq.x: -2.217383<br />freq.y: -2.288718","projects<br />freq.x: -2.638468<br />freq.y: -2.652675","provide<br />freq.x: -2.378419<br />freq.y: -2.381529","read<br />freq.x: -2.410691<br />freq.y: -2.269789","reading<br />freq.x: -2.079835<br />freq.y: -1.982943","real<br />freq.x: -2.860875<br />freq.y: -2.914756","research<br />freq.x: -2.734703<br />freq.y: -2.658020","resources<br />freq.x: -2.612260<br />freq.y: -2.737906","school<br />freq.x: -1.933443<br />freq.y: -2.009951","science<br />freq.x: -2.369326<br />freq.y: -2.464639","seating<br />freq.x: -2.437706<br />freq.y: -2.514687","sit<br />freq.x: -2.753571<br />freq.y: -2.671073","skills<br />freq.x: -2.083475<br />freq.y: -2.143420","social<br />freq.x: -2.790476<br />freq.y: -2.873963","space<br />freq.x: -2.845272<br />freq.y: -2.815176","stem<br />freq.x: -2.824053<br />freq.y: -2.966034","student<br />freq.x: -2.310988<br />freq.y: -2.317863","students<br />freq.x: -1.193225<br />freq.y: -1.190170","success<br />freq.x: -2.811036<br />freq.y: -2.933711","successful<br />freq.x: -2.721733<br />freq.y: -2.820742","supplies<br />freq.x: -2.308213<br />freq.y: -2.594053","support<br />freq.x: -2.699855<br />freq.y: -2.744851","teach<br />freq.x: -2.624294<br />freq.y: -2.698370","teacher<br />freq.x: -2.674669<br />freq.y: -2.743798","teaching<br />freq.x: -2.799701<br />freq.y: -2.901801","technology<br />freq.x: -2.217822<br />freq.y: -2.180317","thinking<br />freq.x: -2.836863<br />freq.y: -2.951568","time<br />freq.x: -2.226005<br />freq.y: -2.191919","tools<br />freq.x: -2.642604<br />freq.y: -2.772730","variety<br />freq.x: -2.746585<br />freq.y: -2.779235","world<br />freq.x: -2.447291<br />freq.y: -2.485463","writing<br />freq.x: -2.560059<br />freq.y: -2.522667"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0.8,"size":9.4488188976378,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.94833255629927,-1.10964886784142],"y":[-2.94833255629927,-1.10964886784142],"text":"intercept: 0<br />slope: 1","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":48.9497716894977},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[-2.94833255629927,-1.10964886784142],"ticktext":["1%"],"tickvals":[-2],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"freq.x","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[-3.06756636338855,-1.10077063001053],"ticktext":["0.1%","1.0%"],"tickvals":[-3,-2],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"freq.y","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest"},"source":"A","attrs":{"1661028682d25":{"text":{},"x":{},"y":{},"type":"ggplotly"},"166104f6becdc":{"intercept":{},"slope":{}}},"cur_data":"1661028682d25","visdat":{"1661028682d25":["function (y) ","x"],"166104f6becdc":["function (y) ","x"]},"config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="which-resources-are-more-likely-to-be-associated-with-approval" class="section level2">
<h2>Which resources are more likely to be associated with approval?</h2>
<pre class="r"><code>id_title &lt;- c(1, 16, 14)

train_text &lt;- train[,id_title]
train_text[,1] &lt;- as.character(train_text[,1])
train_text[,2] &lt;- as.numeric(train_text[,2])
train_text[,3] &lt;- as.character(train_text[,3])


train_text &lt;- as.tibble(train_text)

tidy_books &lt;- train_text %&gt;% unnest_tokens(word, project_resource_summary)

# Take out stop (common) words

tidy_books &lt;- tidy_books %&gt;%
  anti_join(stop_words)</code></pre>
<pre><code>Joining, by = &quot;word&quot;</code></pre>
<pre class="r"><code>word_counts &lt;- tidy_books %&gt;%
  anti_join(stop_words) %&gt;%
  count(id, word, sort = TRUE) %&gt;%
  ungroup()</code></pre>
<pre><code>Joining, by = &quot;word&quot;</code></pre>
<pre class="r"><code>frequency &lt;- tidy_books %&gt;% 
  group_by(project_is_approved) %&gt;% 
  count(word, sort = TRUE) %&gt;% 
  left_join(tidy_books %&gt;% 
              group_by(project_is_approved) %&gt;% 
              summarise(total = n())) %&gt;%
  mutate(freq = n/total)</code></pre>
<pre><code>Joining, by = &quot;project_is_approved&quot;</code></pre>
<pre class="r"><code>summary(frequency$n)</code></pre>
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
     1.00      1.00      2.00     47.54      9.00 168279.00 </code></pre>
<pre class="r"><code># Select words that have been used at least 2000 times

frequency_50 &lt;- frequency[which(frequency$n &gt; 1500),]

frequency_50_0 &lt;- frequency_50[which(frequency_50$project_is_approved != 1), ]
frequency_50_1 &lt;- frequency_50[which(frequency_50$project_is_approved == 1), ]

appears_twice &lt;- merge(frequency_50_0, frequency_50_1, by = c(&quot;word&quot;))
dim(appears_twice)</code></pre>
<pre><code>[1] 17  9</code></pre>
<pre class="r"><code>ggplot(appears_twice, aes(freq.x, freq.y)) +
  geom_point(alpha = 0.8, size = 2.5, width = 0.25, height = 0.25) +
  geom_label_repel(aes(label = word)) +
  scale_x_log10(labels = percent_format()) +
  scale_y_log10(labels = percent_format()) +
  geom_abline(color = &quot;red&quot;)</code></pre>
<pre><code>Warning: Ignoring unknown parameters: width, height</code></pre>
<p><img src="figure/Word_frequency.Rmd/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>p &lt;- ggplot(appears_twice, aes(freq.x, freq.y)) + 
  geom_point(aes(text = word), alpha = 0.8, size = 2.5, width = 0.25, height = 0.25)  +
  scale_x_log10(labels = percent_format()) +
  scale_y_log10(labels = percent_format()) +
  geom_abline(color = &quot;red&quot;)</code></pre>
<pre><code>Warning: Ignoring unknown parameters: width, height</code></pre>
<pre><code>Warning: Ignoring unknown aesthetics: text</code></pre>
<pre class="r"><code>ggplotly(p)</code></pre>
<pre><code>We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`</code></pre>
<div id="166105e55c953" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="166105e55c953">{"x":{"data":[{"x":[-2.22026241057807,-2.00041679676938,-1.80332259113832,-2.26644714611359,-2.2098823922767,-2.10978195550348,-1.75430081541314,-1.90350678376133,-2.02406094667823,-1.99565525342673,-2.19415960801386,-2.21694424676418,-2.08902805838723,-2.08226262458249,-0.960937802160267,-1.90363035595789,-2.16726333481253],"y":[-2.44539077205388,-1.86202849750011,-1.77966079764288,-2.36958740378152,-2.49760768134057,-2.1578824904446,-1.80081234406206,-2.23561481804956,-2.10903653982436,-1.90950660873022,-2.26866411495962,-2.33699762382857,-2.18915670617289,-2.13256038089327,-0.95687154017496,-2.26408507236698,-2.17183876799762],"text":["activities<br />freq.x: -2.2202624<br />freq.y: -2.4453908","books<br />freq.x: -2.0004168<br />freq.y: -1.8620285","classroom<br />freq.x: -1.8033226<br />freq.y: -1.7796608","create<br />freq.x: -2.2664471<br />freq.y: -2.3695874","hands<br />freq.x: -2.2098824<br />freq.y: -2.4976077","learn<br />freq.x: -2.1097820<br />freq.y: -2.1578825","learning<br />freq.x: -1.7543008<br />freq.y: -1.8008123","materials<br />freq.x: -1.9035068<br />freq.y: -2.2356148","math<br />freq.x: -2.0240609<br />freq.y: -2.1090365","reading<br />freq.x: -1.9956553<br />freq.y: -1.9095066","school<br />freq.x: -2.1941596<br />freq.y: -2.2686641","science<br />freq.x: -2.2169442<br />freq.y: -2.3369976","seating<br />freq.x: -2.0890281<br />freq.y: -2.1891567","skills<br />freq.x: -2.0822626<br />freq.y: -2.1325604","students<br />freq.x: -0.9609378<br />freq.y: -0.9568715","supplies<br />freq.x: -1.9036304<br />freq.y: -2.2640851","technology<br />freq.x: -2.1672633<br />freq.y: -2.1718388"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0.8,"size":9.4488188976378,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.33172261331125,-0.895662334962601],"y":[-2.33172261331125,-0.895662334962601],"text":"intercept: 0<br />slope: 1","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[-2.33172261331125,-0.895662334962601],"ticktext":["1%","10%"],"tickvals":[-2,-1],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"freq.x","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[-2.57464448839885,-0.87983473311668],"ticktext":["1%","10%"],"tickvals":[-2,-1],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"freq.y","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest"},"source":"A","attrs":{"16610171f5eb5":{"text":{},"x":{},"y":{},"type":"ggplotly"},"16610c82c8ef":{"intercept":{},"slope":{}}},"cur_data":"16610171f5eb5","visdat":{"16610171f5eb5":["function (y) ","x"],"16610c82c8ef":["function (y) ","x"]},"config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="which-titles-are-more-likely-to-be-associated-with-approval" class="section level2">
<h2>Which titles are more likely to be associated with approval?</h2>
<pre class="r"><code>id_title &lt;- c(1, 16, 9)

train_text &lt;- train[,id_title]
train_text[,1] &lt;- as.character(train_text[,1])
train_text[,2] &lt;- as.numeric(train_text[,2])
train_text[,3] &lt;- as.character(train_text[,3])


train_text &lt;- as.tibble(train_text)

tidy_books &lt;- train_text %&gt;% unnest_tokens(word, project_title)

# Take out stop (common) words

tidy_books &lt;- tidy_books %&gt;%
  anti_join(stop_words)</code></pre>
<pre><code>Joining, by = &quot;word&quot;</code></pre>
<pre class="r"><code>word_counts &lt;- tidy_books %&gt;%
  anti_join(stop_words) %&gt;%
  count(id, word, sort = TRUE) %&gt;%
  ungroup()</code></pre>
<pre><code>Joining, by = &quot;word&quot;</code></pre>
<pre class="r"><code>frequency &lt;- tidy_books %&gt;% 
  group_by(project_is_approved) %&gt;% 
  count(word, sort = TRUE) %&gt;% 
  left_join(tidy_books %&gt;% 
              group_by(project_is_approved) %&gt;% 
              summarise(total = n())) %&gt;%
  mutate(freq = n/total)</code></pre>
<pre><code>Joining, by = &quot;project_is_approved&quot;</code></pre>
<pre class="r"><code>summary(frequency$n)</code></pre>
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
    1.00     1.00     2.00    19.34     5.00 13114.00 </code></pre>
<pre class="r"><code># Select words that have been used at least 2000 times

frequency_50 &lt;- frequency[which(frequency$n &gt; 300),]

frequency_50_0 &lt;- frequency_50[which(frequency_50$project_is_approved != 1), ]
frequency_50_1 &lt;- frequency_50[which(frequency_50$project_is_approved == 1), ]

appears_twice &lt;- merge(frequency_50_0, frequency_50_1, by = c(&quot;word&quot;))
dim(appears_twice)</code></pre>
<pre><code>[1] 42  9</code></pre>
<pre class="r"><code>ggplot(appears_twice, aes(freq.x, freq.y)) +
  geom_point(alpha = 0.8, size = 2.5, width = 0.25, height = 0.25) +
  geom_label_repel(aes(label = word)) +
  scale_x_log10(labels = percent_format()) +
  scale_y_log10(labels = percent_format()) +
  geom_abline(color = &quot;red&quot;)</code></pre>
<pre><code>Warning: Ignoring unknown parameters: width, height</code></pre>
<p><img src="figure/Word_frequency.Rmd/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>p &lt;- ggplot(appears_twice, aes(freq.x, freq.y)) + 
  geom_point(aes(text = word), alpha = 0.8, size = 2.5, width = 0.25, height = 0.25)  +
  scale_x_log10(labels = percent_format()) +
  scale_y_log10(labels = percent_format()) +
  geom_abline(color = &quot;red&quot;)</code></pre>
<pre><code>Warning: Ignoring unknown parameters: width, height</code></pre>
<pre><code>Warning: Ignoring unknown aesthetics: text</code></pre>
<pre class="r"><code>ggplotly(p)</code></pre>
<pre><code>We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`</code></pre>
<div id="166102c47caae" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="166102c47caae">{"x":{"data":[{"x":[-2.44047008727452,-2.11639878767901,-2.1359740358477,-2.3103425854573,-2.3271696580783,-1.74429298312268,-1.90240897799499,-2.0772921848617,-2.2542891678784,-2.12708965322411,-2.19347308244118,-2.42542215896186,-2.31241065832667,-2.32609864771577,-2.0342575526365,-2.27661328463586,-1.54140056493167,-2.40570798101531,-2.30014741113224,-2.40059857523683,-2.40570798101531,-1.87733903687475,-2.31553135066622,-2.34467507996726,-2.26717172840301,-2.19111491656454,-2.37114359589856,-1.90362039992943,-2.19743203858823,-2.02081082890925,-1.84120299613073,-2.40957987425612,-2.40828540390312,-2.41742878334299,-2.0601428635935,-2.38439632823787,-1.83356532638485,-2.26437882821884,-1.91260894147525,-1.83253415578113,-2.39179925433379,-2.27756882843586],"y":[-2.37966043190367,-2.27903515447487,-1.88971458937981,-2.39489265101841,-2.32855611886766,-1.77586845629852,-2.04604306903609,-2.21012633538609,-2.34989972402623,-2.16182165581154,-2.45633254855428,-2.42153062616102,-2.30163769132969,-2.32874901004645,-2.06496419219938,-2.23303683835463,-1.56338932571647,-2.43536514907969,-2.3085807042879,-2.35890521031305,-2.71875516937695,-2.03974955985484,-2.40077381200096,-2.30582676682963,-2.47809161803226,-2.10455282098168,-2.21618807592523,-1.83733130672105,-2.30345406571264,-2.16764054834271,-1.95050370715968,-2.76414445772658,-2.53036806518666,-2.55564323934637,-2.26565033693773,-2.45221109905228,-1.82234676774152,-2.25952057817714,-2.15504381324494,-1.75622524103268,-2.31751252515482,-2.25738725506464],"text":["active<br />freq.x: -2.440470<br />freq.y: -2.379660","art<br />freq.x: -2.116399<br />freq.y: -2.279035","books<br />freq.x: -2.135974<br />freq.y: -1.889715","building<br />freq.x: -2.310343<br />freq.y: -2.394893","class<br />freq.x: -2.327170<br />freq.y: -2.328556","classroom<br />freq.x: -1.744293<br />freq.y: -1.775868","flexible<br />freq.x: -1.902409<br />freq.y: -2.046043","fun<br />freq.x: -2.077292<br />freq.y: -2.210126","future<br />freq.x: -2.254289<br />freq.y: -2.349900","grade<br />freq.x: -2.127090<br />freq.y: -2.161822","hands<br />freq.x: -2.193473<br />freq.y: -2.456333","healthy<br />freq.x: -2.425422<br />freq.y: -2.421531","kids<br />freq.x: -2.312411<br />freq.y: -2.301638","kindergarten<br />freq.x: -2.326099<br />freq.y: -2.328749","learn<br />freq.x: -2.034258<br />freq.y: -2.064964","learners<br />freq.x: -2.276613<br />freq.y: -2.233037","learning<br />freq.x: -1.541401<br />freq.y: -1.563389","life<br />freq.x: -2.405708<br />freq.y: -2.435365","literacy<br />freq.x: -2.300147<br />freq.y: -2.308581","love<br />freq.x: -2.400599<br />freq.y: -2.358905","materials<br />freq.x: -2.405708<br />freq.y: -2.718755","math<br />freq.x: -1.877339<br />freq.y: -2.039750","minds<br />freq.x: -2.315531<br />freq.y: -2.400774","move<br />freq.x: -2.344675<br />freq.y: -2.305827","play<br />freq.x: -2.267172<br />freq.y: -2.478092","read<br />freq.x: -2.191115<br />freq.y: -2.104553","readers<br />freq.x: -2.371144<br />freq.y: -2.216188","reading<br />freq.x: -1.903620<br />freq.y: -1.837331","school<br />freq.x: -2.197432<br />freq.y: -2.303454","science<br />freq.x: -2.020811<br />freq.y: -2.167641","seating<br />freq.x: -1.841203<br />freq.y: -1.950504","sensory<br />freq.x: -2.409580<br />freq.y: -2.764144","special<br />freq.x: -2.408285<br />freq.y: -2.530368","steam<br />freq.x: -2.417429<br />freq.y: -2.555643","stem<br />freq.x: -2.060143<br />freq.y: -2.265650","student<br />freq.x: -2.384396<br />freq.y: -2.452211","students<br />freq.x: -1.833565<br />freq.y: -1.822347","success<br />freq.x: -2.264379<br />freq.y: -2.259521","supplies<br />freq.x: -1.912609<br />freq.y: -2.155044","technology<br />freq.x: -1.832534<br />freq.y: -1.756225","time<br />freq.x: -2.391799<br />freq.y: -2.317513","world<br />freq.x: -2.277569<br />freq.y: -2.257387"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0.8,"size":9.4488188976378,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.48542356339167,-1.49644708881453],"y":[-2.48542356339167,-1.49644708881453],"text":"intercept: 0<br />slope: 1","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":37.2602739726027},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[-2.48542356339167,-1.49644708881453],"ticktext":["1%"],"tickvals":[-2],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"freq.x","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[-2.82418221432709,-1.50335156911596],"ticktext":["1%"],"tickvals":[-2],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"freq.y","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest"},"source":"A","attrs":{"16610131d0618":{"text":{},"x":{},"y":{},"type":"ggplotly"},"16610567b1b75":{"intercept":{},"slope":{}}},"cur_data":"16610131d0618","visdat":{"16610131d0618":["function (y) ","x"],"16610567b1b75":["function (y) ","x"]},"config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="session-information" class="section level2">
<h2>Session information</h2>
<!-- Insert the session information into the document -->
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 3.4.3 (2017-11-30)
Platform: x86_64-apple-darwin15.6.0 (64-bit)
Running under: OS X El Capitan 10.11.6

Matrix products: default
BLAS: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] ggrepel_0.7.0   scales_0.5.0    bindrcpp_0.2    plotly_4.7.1   
 [5] quanteda_1.1.1  forcats_0.2.0   purrr_0.2.4     readr_1.1.1    
 [9] tidyr_0.7.2     tibble_1.4.2    tidyverse_1.2.1 ggplot2_2.2.1  
[13] tidytext_0.1.8  stringr_1.3.0   dplyr_0.7.4    

loaded via a namespace (and not attached):
 [1] Rcpp_0.12.15        lubridate_1.7.1     lattice_0.20-35    
 [4] assertthat_0.2.0    rprojroot_1.3-2     digest_0.6.15      
 [7] psych_1.7.8         mime_0.5            R6_2.2.2           
[10] cellranger_1.1.0    plyr_1.8.4          backports_1.1.2    
[13] evaluate_0.10.1     httr_1.3.1          pillar_1.1.0       
[16] rlang_0.1.6         lazyeval_0.2.1      readxl_1.0.0       
[19] rstudioapi_0.7      data.table_1.10.4-3 Matrix_1.2-13      
[22] rmarkdown_1.9       labeling_0.3        foreign_0.8-69     
[25] htmlwidgets_1.0     munsell_0.4.3       shiny_1.0.5        
[28] broom_0.4.3         httpuv_1.3.6.2      compiler_3.4.3     
[31] janeaustenr_0.1.5   spacyr_0.9.6        modelr_0.1.1       
[34] pkgconfig_2.0.1     mnormt_1.5-5        htmltools_0.3.6    
[37] tidyselect_0.2.3    viridisLite_0.3.0   crayon_1.3.4       
[40] SnowballC_0.5.1     grid_3.4.3          xtable_1.8-2       
[43] nlme_3.1-131        jsonlite_1.5        gtable_0.2.0       
[46] git2r_0.21.0        magrittr_1.5        tokenizers_0.2.0   
[49] RcppParallel_4.4.0  cli_1.0.0           stringi_1.1.7      
[52] reshape2_1.4.3      xml2_1.1.1          stopwords_0.9.0    
[55] fastmatch_1.1-0     tools_3.4.3         glue_1.2.0         
[58] crosstalk_1.0.0     hms_0.4.0           network_1.13.0.1   
[61] parallel_3.4.3      yaml_2.1.18         colorspace_1.3-2   
[64] rvest_0.3.2         knitr_1.20          bindr_0.1          
[67] haven_1.1.1        </code></pre>
</div>
</div>

<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>

<hr>
<p>
    This <a href="http://rmarkdown.rstudio.com">R Markdown</a> site was created with <a href="https://github.com/jdblischak/workflowr">workflowr</a>
</p>
<hr>

<!-- To enable disqus, uncomment the section below and provide your disqus_shortname -->

<!-- disqus
  <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'rmarkdown'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
-->


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
